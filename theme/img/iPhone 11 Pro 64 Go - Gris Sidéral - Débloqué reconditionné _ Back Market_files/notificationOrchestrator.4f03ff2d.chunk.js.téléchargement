(window.idzJsonpFunction=window.idzJsonpFunction||[]).push([[13],{398:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CLOSE_NOTIFICATION=t.MAXIMIZE_NOTIFICATION=t.MINIMIZE_NOTIFICATION=t.ENGAGEMENT_ACCEPTED=void 0;t.ENGAGEMENT_ACCEPTED="ENGAGEMENT_ACCEPTED";t.MINIMIZE_NOTIFICATION="MINIMIZE_NOTIFICATION";t.MAXIMIZE_NOTIFICATION="MAXIMIZE_NOTIFICATION";t.CLOSE_NOTIFICATION="CLOSE_NOTIFICATION"},422:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PREFETCH_BOT_SCENARIO_REQUESTED=t.NOTIFICATION_CANCELED=t.CANCEL_NOTIFICATION=t.SHOW_NOTIFICATION=void 0;t.SHOW_NOTIFICATION="SHOW_NOTIFICATION";t.CANCEL_NOTIFICATION="CANCEL_NOTIFICATION";t.NOTIFICATION_CANCELED="NOTIFICATION_CANCELED";t.PREFETCH_BOT_SCENARIO_REQUESTED="PREFETCH_BOT_SCENARIO_REQUESTED"},602:function(e,t,i){var n=i(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(43),o=n(i(687)),r=n(i(689));var c=(0,a.createStore)(r.default,(0,a.applyMiddleware)(o.default));t.default=c},603:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.notificationMobilePositionFlag=t.isNotificationMinimizedFlagPrefix=void 0;t.isNotificationMinimizedFlagPrefix="isNotificationMinimized.";t.notificationMobilePositionFlag="notificationMobilePosition"},604:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.prefetchBotScenarioRequested=t.notificationCanceled=t.cancelNotification=t.showNotification=void 0;var n=i(422),a=function(e,t,i){return{type:n.SHOW_NOTIFICATION,payload:{notification:e,ruleId:t,routingRuleId:i}}};t.showNotification=a;var o=function(e){return{type:n.CANCEL_NOTIFICATION,payload:{notification:e}}};t.cancelNotification=o;t.notificationCanceled=function(e){return{type:n.NOTIFICATION_CANCELED,payload:{notification:e}}};t.prefetchBotScenarioRequested=function(e,t){return{type:n.PREFETCH_BOT_SCENARIO_REQUESTED,payload:{routingRuleId:e,ruleId:t}}};var r={showNotification:a,cancelNotification:o};t.default=r},608:function(e,t,i){var n=i(2);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"store",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"actions",{enumerable:!0,get:function(){return o.default}});var a=n(i(602)),o=n(i(604))},687:function(e,t,i){var n=i(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(i(92)),o=n(i(86)),r=i(180),c=i(18),d=n(i(146)),f=i(688),u=i(398),l=i(422),I=i(68),s=i(22),O=i(603),N=i(400),p=i(401),T=i(604),E=i(399),C=i(112),v=i(198),y=(0,C.isPrefetchableRuleFactory)(c.idz);t.default=function(e){return function(t){return function(i){switch(t(i),i.type){case l.SHOW_NOTIFICATION:var n=i.payload.notification,C=e.getState().bridgeWithOldTargetingState,b=C.curlang,g=C.deviceType;(0,f.displayNotification)(n,g,b);break;case l.CANCEL_NOTIFICATION:var _=i.payload.notification;(0,f.hideNotification)(_,(function(){e.dispatch((0,T.notificationCanceled)(_))}));break;case u.ENGAGEMENT_ACCEPTED:var A=i.payload,M=A.notification,m=A.ruleId,P=A.channel,S=A.routingRuleId,F=A.position;c.eventManager.emit(s.EngagementNotificationClicked,{action:M});var h=S&&y(m,S),j=(0,a.default)(M.parameters.buttons,(function(e){return e.channel===P})),R=M.parameters.buttons||[M.parameters.button];(0,o.default)(R,{channel:r.CHANNELS.CHAT})&&S&&h&&e.dispatch((0,T.prefetchBotScenarioRequested)(S,m));var w={ruleId:m,isPrefetchCase:h,position:F,vuid:c.idz.vuid,actionId:M.id,notificationTemplate:M.notification};switch(P){case r.CHANNELS.CHAT:c.eventManager.emit(I.showChatboxButtonClickedBeforeBundle,w);break;case r.CHANNELS.CALL:c.eventManager.emit(I.showCallButtonClickedBeforeBundle,w);break;case r.CHANNELS.VIDEO:c.eventManager.emit(c.eventManager.events.OnConversationVisioRequestedBeforeBundle,w);break;case r.CHANNELS.MESSENGER:(0,N.redirectToMessenger)(j.offsiteProfileExternalId);break;case r.CHANNELS.SMS:(0,p.redirectToSMS)(j.offsiteProfileExternalId)}break;case u.MINIMIZE_NOTIFICATION:var D,L=i.payload.notification;d.default.saveData(((D={})[""+O.isNotificationMinimizedFlagPrefix+L.id]=!0,D)),c.eventManager.emit(s.EngagementNotificationMinimized,{action:L});break;case u.MAXIMIZE_NOTIFICATION:var z,B=i.payload.notification;d.default.saveData(((z={})[""+O.isNotificationMinimizedFlagPrefix+B.id]=!1,z)),c.eventManager.emit(s.EngagementNotificationMaximized,{action:B});break;case u.CLOSE_NOTIFICATION:var k=i.payload.notification,H=(0,v.makeIframeId)(k),x=document.getElementById(H);x.style.setProperty("transition","opacity 0.3s, transform 0.3s"),x.style.setProperty("opacity",0),k.notification.templateType!==r.TEMPLATED_NOTIFICATION_TYPES.INVITATION&&x.style.setProperty("transform","translateY(100%)"),setTimeout((function(){x.style.setProperty("display","none"),c.eventManager.emit(s.EngagementNotificationClose,k.id)}),300);break;case l.PREFETCH_BOT_SCENARIO_REQUESTED:var W=i.payload,Z=W.routingRuleId,G=W.ruleId,U=e.getState().bridgeWithOldTargetingState,Q=U.curlang,X=U.websiteId;(0,v.fetchAndRetry)((function(){return(0,E.prefetchBotScenario)(Z,X,Q)}),3,50).then((function(e){var t=e.data,i={routingRuleId:Z,ruleId:G,messages:t,vuid:c.idz.vuid};c.eventManager.emit(s.EngagementShowChatboxWithPrefetchedScenario,i)}),(function(){var e={routingRuleId:Z,ruleId:G,vuid:c.idz.vuid};c.eventManager.emit(s.EngagementShowChatboxWithPrefetchedScenarioFailed,e)}))}}}}},688:function(e,t,i){var n=i(2);Object.defineProperty(t,"__esModule",{value:!0}),t.hideNotification=t.displayNotification=void 0;var a=n(i(15)),o=n(i(50)),r=i(423),c=i(282),d=i(18),f=i(198),u=n(i(602)),l=i(47);function I(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I(Object(i),!0).forEach((function(t){(0,a.default)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var O=["notification.js"].map(f.buildJsBundleUrl),N=["notification.css"].map(f.buildJsBundleUrl);t.displayNotification=function(e,t,i){var n=s(s({},(0,r.getNotificationContainerCssPosition)(e.notification,(0,f.deviceTypeToMediaType)(t))),{},{position:"fixed","border-style":"none","z-index":"1000000000"});(0,l.startPerformanceMeasure)(l.PerformanceMarks.NOTIFICATION_DISPLAY);var a=(0,f.makeIframeId)(e);(0,c.addIfDoesNotExistIframe)(document.body,{store:u.default,translate:d.translate,notificationId:e.id},a,"notificationApp",i,n,O,N,(0,d.translate)("livechat.templatedNotification.iframe.label"))};t.hideNotification=function(e,t){void 0===t&&(t=o.default),(0,c.destroyIframeByID)((0,f.makeIframeId)(e)),t()}},689:function(e,t,i){var n=i(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(43),o=n(i(690)),r=n(i(691)),c=(0,a.combineReducers)({bridgeWithOldTargetingState:o.default,notifications:r.default});t.default=c},690:function(e,t,i){var n=i(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(18),o=n(i(283)),r=(0,n(i(200)).default)().deviceType,c={deviceType:r,curlang:a.idz.curlang,websiteId:a.idz.website_id,media:(0,o.default)(r)};t.default=function(e){return void 0===e&&(e=c),e}},691:function(e,t,i){var n=i(2);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(i(15)),o=n(i(183)),r=n(i(125)),c=n(i(181)),d=i(422),f=i(398),u=i(18),l=i(603);function I(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I(Object(i),!0).forEach((function(t){(0,a.default)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var O=(0,r.default)(u.idz.flags,(function(e,t,i){return(0,c.default)(i,l.isNotificationMinimizedFlagPrefix)&&"1"===t&&(e[i.substring(l.isNotificationMinimizedFlagPrefix.length)]={isMinimized:!0}),e}),{}),N=function(e,t){var i,n,a;switch(void 0===e&&(e=O),t.type){case d.SHOW_NOTIFICATION:return s(s({},e),{},((i={})[t.payload.notification.id]=s(s({},e[t.payload.notification.id]),{},{ruleId:t.payload.ruleId,routingRuleId:t.payload.routingRuleId,notification:t.payload.notification}),i));case d.NOTIFICATION_CANCELED:return s({},(0,o.default)(e,t.payload.notification.id));case f.MINIMIZE_NOTIFICATION:return s(s({},e),{},((n={})[t.payload.notification.id]=s(s({},e[t.payload.notification.id]),{},{isMinimized:!0}),n));case f.MAXIMIZE_NOTIFICATION:return s(s({},e),{},((a={})[t.payload.notification.id]=s(s({},e[t.payload.notification.id]),{},{isMinimized:!1}),a));default:return e}};t.default=N}}]);